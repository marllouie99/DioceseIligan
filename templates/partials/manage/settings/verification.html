{% load static %}
{# Verification Settings Section #}
<div id="verification-settings" class="settings-section">
  <div class="section-header">
    <div class="section-header-content">
      <h3 class="section-title">Church Verification</h3>
      <p class="section-description">Upload legal documents to verify your church</p>
    </div>
    {% if not latest_verification or latest_verification.status != 'pending' %}
      <button type="button" class="edit-section-btn" data-section="verification-settings" title="Edit section">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
        </svg>
      </button>
    {% endif %}
  </div>
  <div class="verification-grid">
    <!-- Verification Status Card -->
    <div class="verification-status-card">
      <div class="status-header">
        <h4>Verification Status</h4>
        <p>Current verification status</p>
      </div>
      <div class="status-body">
        {% if church.is_verified %}
          <div class="status-indicator verified">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20,6 9,17 4,12"/>
            </svg>
            <div class="status-text">
              <span class="status-label">Verified</span>
              <span class="status-desc">Your church is verified</span>
            </div>
          </div>
        {% elif latest_verification and latest_verification.status == 'pending' %}
          <div class="status-indicator pending">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            <div class="status-text">
              <span class="status-label">Pending Review</span>
              <span class="status-desc">Your documents are being reviewed by our team</span>
            </div>
          </div>
        {% elif latest_verification and latest_verification.status == 'rejected' %}
          <div class="status-indicator rejected">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="15" y1="9" x2="9" y2="15"/>
              <line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
            <div class="status-text">
              <span class="status-label">Rejected</span>
              <span class="status-desc">Please review the feedback and resubmit</span>
            </div>
          </div>
        {% else %}
          <div class="status-indicator not-verified">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <circle cx="12" cy="16" r="1"/>
            </svg>
            <div class="status-text">
              <span class="status-label">Not Verified</span>
              <span class="status-desc">Click edit button to submit documents</span>
            </div>
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Upload Documents Card -->
    {% if not church.is_verified %}
      <div class="upload-documents-card">
        <div class="upload-header">
          <h4>
            {% if latest_verification and latest_verification.status == 'pending' %}
              Submitted Documents
            {% else %}
              Upload Documents
            {% endif %}
          </h4>
          <p>
            {% if latest_verification and latest_verification.status == 'pending' %}
              Documents awaiting review
            {% else %}
              Submit legal documents for verification
            {% endif %}
          </p>
          {% if not latest_verification or latest_verification.status != 'pending' %}
            <div class="requirement-badge">
              <span class="badge-icon">âš </span>
              <span class="badge-text">Required</span>
              <span class="badge-desc">At least 2 documents required</span>
            </div>
          {% endif %}
        </div>
        <div class="upload-body">
          {% if latest_verification and latest_verification.status == 'pending' %}
            {# Show submitted documents #}
            <div class="submitted-documents-list">
              {% for doc in latest_verification.documents.all %}
                <div class="submitted-document-item">
                  <div class="file-icon {{ doc.file.name|slice:'-3:'|lower }}">
                    {{ doc.file.name|slice:"-3:"|upper }}
                  </div>
                  <div class="file-info">
                    <p class="file-name">{{ doc.title|default:doc.file.name }}</p>
                    <p class="file-meta">Uploaded {{ doc.uploaded_at|date:"M d, Y" }}</p>
                  </div>
                  <a href="{{ doc.file.url }}" target="_blank" class="file-view-btn" title="View document">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </a>
                </div>
              {% endfor %}
            </div>
            <div class="pending-notice">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="16" x2="12" y2="12"/>
                <line x1="12" y1="8" x2="12.01" y2="8"/>
              </svg>
              <p>Your verification request is being reviewed. You will be notified once the review is complete.</p>
            </div>
          {% else %}
            {# Show upload form #}
            <div class="form-fields" id="verification-form-fields">
              {{ verif_form.as_p }}
            </div>
            <div class="selected-files-preview" id="selected-files-preview" style="display: none;">
              <h5 class="preview-title">Selected Documents:</h5>
              <ul class="files-list" id="files-list"></ul>
            </div>
            <div class="verification-submit-container" id="verification-submit-container" style="display: none;">
              <button type="button" class="btn btn-primary btn-submit-verification" id="submit-verification-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                Submit for Verification
              </button>
              <p class="submit-help-text">Your documents will be reviewed by our team</p>
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}
  </div>
</div>
