{% extends 'layouts/app_base.html' %}
{% load static %}

{% block title %}System Overview â€¢ ChurchConnect{% endblock %}

{% block body_class %}dashboard-page{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/variables/blue-sky-vars.css' %}?v={{ STATIC_VERSION }}">
<link rel="stylesheet" href="{% static 'css/themes/blue-sky-theme.css' %}?v={{ STATIC_VERSION }}">
<link rel="stylesheet" href="{% static 'css/components/buttons.css' %}?v={{ STATIC_VERSION }}">
<link rel="stylesheet" href="{% static 'css/components/cards.css' %}?v={{ STATIC_VERSION }}">
<link rel="stylesheet" href="{% static 'css/components/forms.css' %}?v={{ STATIC_VERSION }}">
<link rel="stylesheet" href="{% static 'css/pages/church_detail.css' %}?v={{ STATIC_VERSION }}">
<style>
/* Full Width Overview Container */
.overview-container {
  max-width: 100%;
  width: 100%;
  padding: 0;
  min-height: 100vh;
  overflow: visible;
}

/* Override dashboard-layout for overview page */
.dashboard-page .overview-container {
  display: block;
}

/* Override any parent overflow constraints */
.content {
  overflow: visible !important;
  min-height: auto !important;
}

/* 4 Column Statistics Grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1.5rem;
  margin-bottom: 2rem;
}

@media (max-width: 1200px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 640px) {
  .stats-grid {
    grid-template-columns: 1fr;
  }
}

/* Stat Cards */
.stat-card-overview {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  border: 1px solid #e5e7eb;
  transition: all 0.3s ease;
}

.stat-card-overview:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.stat-icon-wrapper {
  width: 56px;
  height: 56px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.stat-card-overview.primary .stat-icon-wrapper {
  background: linear-gradient(135deg, #1E90FF 0%, #4169E1 100%);
  color: white;
}

.stat-card-overview.success .stat-icon-wrapper {
  background: linear-gradient(135deg, #059669 0%, #10b981 100%);
  color: white;
}

.stat-card-overview.info .stat-icon-wrapper {
  background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
  color: white;
}

.stat-card-overview.warning .stat-icon-wrapper {
  background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
  color: white;
}

.stat-card-overview.purple .stat-icon-wrapper {
  background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
  color: white;
}

.stat-card-overview.success-alt .stat-icon-wrapper {
  background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
  color: white;
}

.stat-card-overview.pink .stat-icon-wrapper {
  background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
  color: white;
}

.stat-card-overview.teal .stat-icon-wrapper {
  background: linear-gradient(135deg, #14b8a6 0%, #2dd4bf 100%);
  color: white;
}

.stat-icon-wrapper svg {
  width: 28px;
  height: 28px;
}

.stat-content {
  flex: 1;
}

.stat-value {
  font-size: 2rem;
  font-weight: 800;
  color: #1f2937;
  line-height: 1;
  margin-bottom: 0.5rem;
}

.stat-label {
  font-size: 0.875rem;
  color: #6b7280;
  font-weight: 500;
  margin-bottom: 0.5rem;
}

.stat-trend {
  display: flex;
  align-items: center;
  gap: 0.375rem;
  font-size: 0.75rem;
}

.trend-icon {
  font-weight: 700;
  font-size: 0.875rem;
}

.trend-icon.positive {
  color: #10b981;
}

.trend-icon.negative {
  color: #ef4444;
}

.trend-icon.neutral {
  color: #6b7280;
}

.trend-text {
  color: #6b7280;
}

/* 2 Column Charts Section */
.charts-section {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1.5rem;
  margin-bottom: 2rem;
}

@media (max-width: 1024px) {
  .charts-section {
    grid-template-columns: 1fr;
  }
}

.chart-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  border: 1px solid #e5e7eb;
}

.chart-title {
  font-size: 1.125rem;
  font-weight: 700;
  color: #1f2937;
  margin: 0 0 0.5rem 0;
}

.chart-subtitle {
  font-size: 0.875rem;
  color: #6b7280;
  margin: 0 0 1.5rem 0;
}

.chart-container-large {
  position: relative;
  height: 320px;
  width: 100%;
}

.chart-container-large canvas {
  max-height: 320px !important;
  height: 320px !important;
  width: 100% !important;
}

/* Recent Church Applications Section */
.applications-section {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  border: 1px solid #e5e7eb;
  margin-bottom: 2rem;
}

.section-header-applications {
  margin-bottom: 1.5rem;
}

.section-title-applications {
  font-size: 1.25rem;
  font-weight: 700;
  color: #1f2937;
  margin: 0 0 0.5rem 0;
}

.section-subtitle {
  font-size: 0.875rem;
  color: #6b7280;
  margin: 0;
}

.applications-table-container {
  overflow-x: auto;
}

.applications-table {
  width: 100%;
  border-collapse: collapse;
}

.applications-table thead {
  background: #f9fafb;
  border-bottom: 2px solid #e5e7eb;
}

.applications-table th {
  padding: 0.75rem 1rem;
  text-align: left;
  font-size: 0.875rem;
  font-weight: 600;
  color: #6b7280;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.applications-table tbody tr {
  border-bottom: 1px solid #e5e7eb;
  transition: background 0.2s ease;
}

.applications-table tbody tr:hover {
  background: #f9fafb;
}

.applications-table td {
  padding: 1rem;
  font-size: 0.875rem;
  color: #1f2937;
}

.user-cell {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.user-avatar-table {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #1E90FF 0%, #4169E1 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 1rem;
  flex-shrink: 0;
}

.user-name-table {
  font-weight: 600;
  color: #1f2937;
}

.church-cell {
  display: flex;
  align-items: center;
}

.church-name-table {
  font-weight: 500;
  color: #3b82f6;
}

.date-text {
  color: #6b7280;
  font-size: 0.875rem;
}

.status-badge {
  display: inline-block;
  padding: 0.375rem 0.75rem;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: lowercase;
}

.status-badge.status-pending {
  background: #fef3c7;
  color: #92400e;
}

.status-badge.status-approved {
  background: #dcfce7;
  color: #166534;
}

.status-badge.status-rejected {
  background: #fee2e2;
  color: #991b1b;
}

.empty-state {
  text-align: center;
  padding: 3rem 1rem;
}

.empty-icon {
  width: 64px;
  height: 64px;
  color: #d1d5db;
  margin: 0 auto 1rem;
}

.empty-text {
  color: #9ca3af;
  font-size: 0.875rem;
  margin: 0;
}

/* Responsive */
@media (max-width: 768px) {
  .stat-value {
    font-size: 1.5rem;
  }
  
  .chart-container-large {
    height: 250px;
  }
  
  .chart-container-large canvas {
    max-height: 250px !important;
    height: 250px !important;
  }
  
  .applications-table th,
  .applications-table td {
    padding: 0.75rem 0.5rem;
    font-size: 0.8125rem;
  }
}

@media (max-width: 520px) {
  .stat-value {
    font-size: 1.25rem;
  }
  
  .chart-container-large {
    height: 200px;
  }
  
  .chart-container-large canvas {
    max-height: 200px !important;
    height: 200px !important;
  }
}
</style>
{% endblock %}

{% block extra_js %}
<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Post Engagement Chart (Line Chart)
  const postEngagementCtx = document.getElementById('postEngagementChart');
  if (postEngagementCtx) {
    new Chart(postEngagementCtx, {
      type: 'line',
      data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [
          {
            label: 'Posts',
            data: [2500, 2300, 3000, 2700, 3200, 4000, 4500],
            borderColor: 'rgba(16, 185, 129, 1)',
            backgroundColor: 'rgba(16, 185, 129, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointRadius: 5,
            pointHoverRadius: 7,
            pointBackgroundColor: 'rgba(16, 185, 129, 1)',
            pointBorderColor: '#fff',
            pointBorderWidth: 2
          },
          {
            label: 'Likes',
            data: [3000, 2800, 3500, 3200, 3800, 4200, 4300],
            borderColor: 'rgba(236, 72, 153, 1)',
            backgroundColor: 'rgba(236, 72, 153, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointRadius: 5,
            pointHoverRadius: 7,
            pointBackgroundColor: 'rgba(236, 72, 153, 1)',
            pointBorderColor: '#fff',
            pointBorderWidth: 2
          },
          {
            label: 'Comments',
            data: [500, 600, 800, 700, 900, 1000, 1200],
            borderColor: 'rgba(59, 130, 246, 1)',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointRadius: 5,
            pointHoverRadius: 7,
            pointBackgroundColor: 'rgba(59, 130, 246, 1)',
            pointBorderColor: '#fff',
            pointBorderWidth: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          intersect: false,
          mode: 'index'
        },
        plugins: {
          legend: {
            display: true,
            position: 'top',
            labels: {
              usePointStyle: true,
              padding: 15,
              font: {
                size: 12,
                weight: '600'
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            borderRadius: 8,
            titleFont: {
              size: 14,
              weight: 'bold'
            },
            bodyFont: {
              size: 13
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              precision: 0,
              font: {
                size: 11
              }
            },
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            }
          },
          x: {
            ticks: {
              font: {
                size: 11
              }
            },
            grid: {
              display: false
            }
          }
        }
      }
    });
  }

  // Churches by Type Chart (Pie Chart)
  const churchesByTypeCtx = document.getElementById('churchesByTypeChart');
  if (churchesByTypeCtx) {
    new Chart(churchesByTypeCtx, {
      type: 'pie',
      data: {
        labels: ['Catholic', 'Protestant', 'Baptist', 'Methodist', 'Other'],
        datasets: [{
          data: [36, 31, 19, 10, 4],
          backgroundColor: [
            'rgba(59, 130, 246, 0.8)',
            'rgba(168, 85, 247, 0.8)',
            'rgba(16, 185, 129, 0.8)',
            'rgba(251, 191, 36, 0.8)',
            'rgba(30, 144, 255, 0.8)'
          ],
          borderColor: [
            'rgba(59, 130, 246, 1)',
            'rgba(168, 85, 247, 1)',
            'rgba(16, 185, 129, 1)',
            'rgba(251, 191, 36, 1)',
            'rgba(30, 144, 255, 1)'
          ],
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: true,
            position: 'right',
            labels: {
              usePointStyle: true,
              padding: 15,
              font: {
                size: 12,
                weight: '600'
              },
              generateLabels: function(chart) {
                const data = chart.data;
                if (data.labels.length && data.datasets.length) {
                  return data.labels.map((label, i) => {
                    const value = data.datasets[0].data[i];
                    const total = data.datasets[0].data.reduce((a, b) => a + b, 0);
                    const percentage = ((value / total) * 100).toFixed(1);
                    return {
                      text: `${label} ${percentage}%`,
                      fillStyle: data.datasets[0].backgroundColor[i],
                      hidden: false,
                      index: i
                    };
                  });
                }
                return [];
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            borderRadius: 8,
            titleFont: {
              size: 14,
              weight: 'bold'
            },
            bodyFont: {
              size: 13
            },
            callbacks: {
              label: function(context) {
                const label = context.label || '';
                const value = context.parsed || 0;
                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                const percentage = ((value / total) * 100).toFixed(1);
                return `${label}: ${percentage}%`;
              }
            }
          }
        }
      }
    });
  }

  // User & Church Growth Chart (Line Chart)
  const growthCtx = document.getElementById('growthChart');
  if (growthCtx) {
    new Chart(growthCtx, {
      type: 'line',
      data: {
        labels: [{% for label in monthly_growth.labels %}'{{ label }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
        datasets: [
          {
            label: 'Churches',
            data: [{% for count in monthly_growth.churches %}{{ count }}{% if not forloop.last %}, {% endif %}{% endfor %}],
            borderColor: 'rgba(59, 130, 246, 1)',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointRadius: 5,
            pointHoverRadius: 7,
            pointBackgroundColor: 'rgba(59, 130, 246, 1)',
            pointBorderColor: '#fff',
            pointBorderWidth: 2
          },
          {
            label: 'Users',
            data: [{% for count in monthly_growth.users %}{{ count }}{% if not forloop.last %}, {% endif %}{% endfor %}],
            borderColor: 'rgba(30, 144, 255, 1)',
            backgroundColor: 'rgba(30, 144, 255, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointRadius: 5,
            pointHoverRadius: 7,
            pointBackgroundColor: 'rgba(30, 144, 255, 1)',
            pointBorderColor: '#fff',
            pointBorderWidth: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          intersect: false,
          mode: 'index'
        },
        plugins: {
          legend: {
            display: true,
            position: 'top',
            labels: {
              usePointStyle: true,
              padding: 15,
              font: {
                size: 12,
                weight: '600'
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            borderRadius: 8,
            titleFont: {
              size: 14,
              weight: 'bold'
            },
            bodyFont: {
              size: 13
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              precision: 0,
              font: {
                size: 11
              }
            },
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            }
          },
          x: {
            ticks: {
              font: {
                size: 11
              }
            },
            grid: {
              display: false
            }
          }
        }
      }
    });
  }

  // Appointment Status Chart (Bar Chart)
  const appointmentCtx = document.getElementById('appointmentChart');
  if (appointmentCtx) {
    new Chart(appointmentCtx, {
      type: 'bar',
      data: {
        labels: [{% for label in monthly_growth.labels %}'{{ label }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
        datasets: [
          {
            label: 'Completed',
            data: [{% for count in monthly_bookings.completed %}{{ count }}{% if not forloop.last %}, {% endif %}{% endfor %}],
            backgroundColor: 'rgba(16, 185, 129, 0.8)',
            borderColor: 'rgba(16, 185, 129, 1)',
            borderWidth: 2,
            borderRadius: 6
          },
          {
            label: 'Pending',
            data: [{% for count in monthly_bookings.pending %}{{ count }}{% if not forloop.last %}, {% endif %}{% endfor %}],
            backgroundColor: 'rgba(251, 191, 36, 0.8)',
            borderColor: 'rgba(251, 191, 36, 1)',
            borderWidth: 2,
            borderRadius: 6
          },
          {
            label: 'Cancelled',
            data: [{% for count in monthly_bookings.cancelled %}{{ count }}{% if not forloop.last %}, {% endif %}{% endfor %}],
            backgroundColor: 'rgba(239, 68, 68, 0.8)',
            borderColor: 'rgba(239, 68, 68, 1)',
            borderWidth: 2,
            borderRadius: 6
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          intersect: false,
          mode: 'index'
        },
        plugins: {
          legend: {
            display: true,
            position: 'top',
            labels: {
              usePointStyle: true,
              padding: 15,
              font: {
                size: 12,
                weight: '600'
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            borderRadius: 8,
            titleFont: {
              size: 14,
              weight: 'bold'
            },
            bodyFont: {
              size: 13
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            stacked: false,
            ticks: {
              precision: 0,
              font: {
                size: 11
              }
            },
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            }
          },
          x: {
            stacked: false,
            ticks: {
              font: {
                size: 11
              }
            },
            grid: {
              display: false
            }
          }
        }
      }
    });
  }
});
</script>
{% endblock %}

{% block sidebar %}
  {% include 'partials/sidebar.html' %}
{% endblock %}

{% block topbar %}
  {% include 'partials/topbar.html' %}
{% endblock %}

{% block content %}
<div class="overview-container">
  <h1 class="section-title">System Overview</h1>
  <p style="color: #6b7280; margin-bottom: 1.5rem;">Comprehensive statistics and insights across the entire ChurchConnect platform</p>
  
  <!-- 4 Column Statistics Cards -->
  <div class="stats-grid">
    <div class="stat-card-overview primary">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M23 21v-2a4 4 0 00-3-3.87"/>
          <path d="M16 3.13a4 4 0 010 7.75"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ user_stats.total_users|default:0 }}</div>
        <div class="stat-label">Total Users</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">+{{ user_stats.new_users_this_month|default:0 }} this month</span>
        </div>
      </div>
    </div>

    <div class="stat-card-overview success">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
          <circle cx="12" cy="10" r="3"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ church_stats.total_churches|default:0 }}</div>
        <div class="stat-label">Active Churches</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">+{{ church_stats.verified_churches|default:0 }} verified</span>
        </div>
      </div>
    </div>

    <div class="stat-card-overview info">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
          <path d="M16 21V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v16"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.bookings|default:0 }}</div>
        <div class="stat-label">Total Bookings</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">+{{ church_stats.new_churches_this_month|default:0 }} this week</span>
        </div>
      </div>
    </div>

    <div class="stat-card-overview warning">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <path d="M12 6v6l4 2"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ verif.counts.pending|default:0 }}</div>
        <div class="stat-label">Pending Reviews</div>
        <div class="stat-trend">
          <span class="trend-icon neutral">→</span>
          <span class="trend-text">Verification + Reports</span>
        </div>
      </div>
    </div>

    <!-- Row 2 Stats -->
    <div class="stat-card-overview purple">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M23 21v-2a4 4 0 00-3-3.87"/>
          <path d="M16 3.13a4 4 0 010 7.75"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ post_stats.total_followers|default:0 }}</div>
        <div class="stat-label">Church Follows</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">+{{ post_stats.new_followers_this_week|default:0 }} this week</span>
        </div>
      </div>
    </div>

    <div class="stat-card-overview success-alt">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">${{ post_stats.total_donations|default:0 }}</div>
        <div class="stat-label">Total Donations</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">+${{ post_stats.donations_this_month|default:0 }} this month</span>
        </div>
      </div>
    </div>

    <div class="stat-card-overview pink">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ post_stats.total_engagement|default:0 }}</div>
        <div class="stat-label">Post Engagement</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">Likes, comments, bookmarks</span>
        </div>
      </div>
    </div>

    <div class="stat-card-overview teal">
      <div class="stat-icon-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ post_stats.posts_this_month|default:0 }}</div>
        <div class="stat-label">Posts This Month</div>
        <div class="stat-trend">
          <span class="trend-icon positive">↑</span>
          <span class="trend-text">{{ post_stats.posts_today|default:0 }} posted today</span>
        </div>
      </div>
    </div>
  </div>

  <!-- 2 Column Charts -->
  <div class="charts-section">
    <div class="chart-card">
      <h3 class="chart-title">Post Engagement</h3>
      <p class="chart-subtitle">Daily post activity and engagement metrics</p>
      <div class="chart-container-large">
        <canvas id="postEngagementChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <h3 class="chart-title">Churches by Type</h3>
      <p class="chart-subtitle">Distribution of church categories</p>
      <div class="chart-container-large">
        <canvas id="churchesByTypeChart"></canvas>
      </div>
    </div>
  </div>

  <!-- 2 Column Charts (Row 2) -->
  <div class="charts-section">
    <div class="chart-card">
      <h3 class="chart-title">User & Church Growth</h3>
      <p class="chart-subtitle">Monthly growth trends over the last 6 months</p>
      <div class="chart-container-large">
        <canvas id="growthChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <h3 class="chart-title">Appointment Status</h3>
      <p class="chart-subtitle">Breakdown by status over 6 months</p>
      <div class="chart-container-large">
        <canvas id="appointmentChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Recent Church Applications -->
  <div class="applications-section">
    <div class="section-header-applications">
      <h2 class="section-title-applications">Recent Church Applications</h2>
      <p class="section-subtitle">Latest user applications to join churches</p>
    </div>
    
    <div class="applications-table-container">
      {% if verif.pending_list %}
      <table class="applications-table">
        <thead>
          <tr>
            <th>User</th>
            <th>Church</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for verification in verif.pending_list %}
          <tr>
            <td>
              <div class="user-cell">
                <div class="user-avatar-table">{{ verification.submitted_by.get_full_name.0|default:verification.submitted_by.username.0|upper }}</div>
                <span class="user-name-table">{{ verification.submitted_by.get_full_name|default:verification.submitted_by.username }}</span>
              </div>
            </td>
            <td>
              <div class="church-cell">
                <span class="church-name-table">{{ verification.church.name }}</span>
              </div>
            </td>
            <td>
              <span class="date-text">{{ verification.created_at|date:"Y-m-d" }}</span>
            </td>
            <td>
              <span class="status-badge status-pending">pending</span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <div class="empty-state">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="empty-icon">
          <path d="M9 11l3 3L22 4"/>
          <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
        </svg>
        <p class="empty-text">No pending church applications</p>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}










